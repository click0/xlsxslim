# xlsxslim

[![PyPI version](https://badge.fury.io/py/xlsxslim.svg)](https://badge.fury.io/py/xlsxslim)
[![License](https://img.shields.io/badge/License-BSD_3--Clause-blue.svg)](https://opensource.org/licenses/BSD-3-Clause)

**–ó–º–µ–Ω—à–µ–Ω–Ω—è —Ä–æ–∑–º—ñ—Ä—É Excel-—Ñ–∞–π–ª—ñ–≤ —à–ª—è—Ö–æ–º –≤–∏–¥–∞–ª–µ–Ω–Ω—è –ø–æ—Ä–æ–∂–Ω—ñ—Ö —Ä—è–¥–∫—ñ–≤, –∫–æ–ª–æ–Ω–æ–∫ —Ç–∞ –∑–∞–π–≤–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è.**

üá¨üáß [English documentation](README.md)

v2.0.2 –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ø—Ä—è–º—É –º–∞–Ω—ñ–ø—É–ª—è—Ü—ñ—é XML/regex ‚Äî –ø—Ä–∞—Ü—é—î –∑ —Ñ–∞–π–ª–∞–º–∏ **–±—É–¥—å-—è–∫–æ–≥–æ —Ä–æ–∑–º—ñ—Ä—É** –±–µ–∑ –ø—Ä–æ–±–ª–µ–º –∑ –ø–∞–º'—è—Ç—Ç—é.

## –ú–æ–∂–ª–∏–≤–æ—Å—Ç—ñ

- üöÄ **–ï—Ñ–µ–∫—Ç–∏–≤–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø–∞–º'—è—Ç—ñ** ‚Äî –æ–±—Ä–æ–±–ª—è—î —Ñ–∞–π–ª–∏ 100+ –ú–ë –∑ < 100 –ú–ë RAM
- üìä **–ü—Ä—è–º–∏–π XML** ‚Äî –±–µ–∑ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ openpyxl –¥–ª—è –æ–±—Ä–æ–±–∫–∏
- üìÅ **–ê–≤—Ç–æ–≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è** ‚Äî –∑–Ω–∞—Ö–æ–¥–∏—Ç—å —î–¥–∏–Ω–∏–π xlsx —É –ø–æ—Ç–æ—á–Ω—ñ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó
- üíæ **–ë–µ–∑–ø–µ—á–Ω–æ** ‚Äî –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —Å—Ç–≤–æ—Ä—é—î –∫–æ–ø—ñ—é –∑ —Å—É—Ñ—ñ–∫—Å–æ–º `_slim`

## –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

```bash
pip install xlsxslim
```

## –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç

```bash
# –ê–≤—Ç–æ–≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —î–¥–∏–Ω–æ–≥–æ xlsx —É –ø–æ—Ç–æ—á–Ω—ñ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó
xlsxslim

# –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ñ–∞–π–ª—É
xlsxslim report.xlsx

# –¢—ñ–ª—å–∫–∏ –∞–Ω–∞–ª—ñ–∑ (–±–µ–∑ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è)
xlsxslim report.xlsx --dry-run

# –ü–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π —Ñ–∞–π–ª
xlsxslim report.xlsx --inplace
```

## –ü—Ä–∏–∫–ª–∞–¥ –≤–∏–≤–æ–¥—É

```
xlsxslim v2.0.2

Input:  report.xlsx (68.64 MB)
Memory:  45.00 MB used, 16.00 GB available

Analyzing...

Sheets: 2

Sheet "Data":
  Used range:  A1:J1047716 ‚Üí A1:I82
  Rows:        1,047,716 ‚Üí 82 (-1,047,634)
  Columns:     10 ‚Üí 9 (-1)

Sheet "Summary":
  Used range:  A1:K1047713 ‚Üí A1:K76
  Rows:        1,047,713 ‚Üí 76 (-1,047,637)

Optimizing...

Output: report_slim.xlsx (156.00 KB)
Saved:  68.49 MB (99.8%)
Memory:  48.00 MB used, 16.00 GB available
```

## –û–ø—Ü—ñ—ó

| –û–ø—Ü—ñ—è | –ö–æ—Ä–æ—Ç–∫–æ | –û–ø–∏—Å |
|-------|---------|------|
| `--output FILE` | `-o` | –®–ª—è—Ö –¥–æ –≤–∏—Ö—ñ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª—É |
| `--inplace` | `-i` | –ü–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π —Ñ–∞–π–ª |
| `--dry-run` | `-n` | –¢—ñ–ª—å–∫–∏ –∞–Ω–∞–ª—ñ–∑, –±–µ–∑ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è |
| `--verbose` | `-v` | –î–µ—Ç–∞–ª—å–Ω–∏–π –≤–∏–≤—ñ–¥ |
| `--quiet` | `-q` | –ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π –≤–∏–≤—ñ–¥ |
| `--suffix TEXT` | `-s` | –°—É—Ñ—ñ–∫—Å –≤–∏—Ö—ñ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª—É (–∑–∞ –∑–∞–º–æ–≤—á.: `_slim`) |
| `--version` | | –ü–æ–∫–∞–∑–∞—Ç–∏ –≤–µ—Ä—Å—ñ—é |
| `--help` | `-h` | –ü–æ–∫–∞–∑–∞—Ç–∏ –¥–æ–≤—ñ–¥–∫—É |

## –Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î

xlsx-—Ñ–∞–π–ª–∏ ‚Äî —Ü–µ ZIP-–∞—Ä—Ö—ñ–≤–∏ –∑ XML. xlsxslim:

1. **–ê–Ω–∞–ª—ñ–∑—É—î** ‚Äî —Å–∫–∞–Ω—É—î XML, —â–æ–± –∑–Ω–∞–π—Ç–∏ —Ñ–∞–∫—Ç–∏—á–Ω—ñ –º–µ–∂—ñ –¥–∞–Ω–∏—Ö
2. **–í–∏–¥–∞–ª—è—î** ‚Äî –ø—Ä–∏–±–∏—Ä–∞—î —Ä—è–¥–∫–∏/–∫–æ–ª–æ–Ω–∫–∏/—è—á–µ–π–∫–∏ –∑–∞ –º–µ–∂–∞–º–∏ –¥–∞–Ω–∏—Ö
3. **–ü–µ—Ä–µ–±—É–¥–æ–≤—É—î** ‚Äî —Å—Ç–≤–æ—Ä—é—î –Ω–æ–≤–∏–π ZIP –∑ –æ–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–∏–º XML

–ù–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ –≤–µ—Å—å workbook —É –ø–∞–º'—è—Ç—å.

## –ß–æ–º—É —Ñ–∞–π–ª–∏ "—Ä–æ–∑–¥—É–≤–∞—é—Ç—å—Å—è"

Excel –≤—ñ–¥—Å—Ç–µ–∂—É—î "used range", —è–∫–∏–π –≤–∫–ª—é—á–∞—î –±—É–¥—å-—è–∫—É —è—á–µ–π–∫—É, –¥–æ —è–∫–æ—ó –∫–æ–ª–∏-–Ω–µ–±—É–¥—å –∑–∞—Å—Ç–æ—Å–æ–≤—É–≤–∞–ª–æ—Å—å —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è:

- Ctrl+Shift+End ‚Üí —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è –∑–∞—Å—Ç–æ—Å–æ–≤–∞–Ω–µ –¥–æ —Ä—è–¥–∫–∞ 1,048,576
- Copy-paste –ø—Ä–∏–Ω–æ—Å–∏—Ç—å –Ω–µ–≤–∏–¥–∏–º–µ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è
- –£–º–æ–≤–Ω–µ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è –Ω–∞ —Ü—ñ–ª–∏—Ö –∫–æ–ª–æ–Ω–∫–∞—Ö
- –í–∏–¥–∞–ª–µ–Ω—ñ –¥–∞–Ω—ñ –∑–∞–ª–∏—à–∞—é—Ç—å –≤—ñ–¥—Ñ–æ—Ä–º–∞—Ç–æ–≤–∞–Ω—ñ –ø–æ—Ä–æ–∂–Ω—ñ —è—á–µ–π–∫–∏

## v2.0 vs v1.x

| –§—É–Ω–∫—Ü—ñ—è | v1.x (openpyxl) | v2.0 (XML) |
|---------|-----------------|------------|
| –§–∞–π–ª 68 –ú–ë | 46+ –ì–ë RAM, –ø–∞–¥–∞—î | < 100 –ú–ë RAM |
| –®–≤–∏–¥–∫—ñ—Å—Ç—å | –ü–æ–≤—ñ–ª—å–Ω–æ | –®–≤–∏–¥–∫–æ |
| –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ | openpyxl | –ù–µ–º–∞—î (stdlib) |

## –ö–æ–¥–∏ –≤–∏—Ö–æ–¥—É

| –ö–æ–¥ | –û–ø–∏—Å |
|-----|------|
| 0 | –£—Å–ø—ñ—Ö |
| 1 | –§–∞–π–ª –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ |
| 2 | –î–µ–∫—ñ–ª—å–∫–∞ —Ñ–∞–π–ª—ñ–≤ (–≤–∫–∞–∂—ñ—Ç—å —è–≤–Ω–æ) |
| 3 | –ü–æ–º–∏–ª–∫–∞ —á–∏—Ç–∞–Ω–Ω—è/–∑–∞–ø–∏—Å—É |
| 4 | –í–∂–µ –æ–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–æ |

## –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

```bash
# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ dev-–∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ (–≤–∫–ª—é—á–∞—î openpyxl –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–µ—Å—Ç–æ–≤–∏—Ö —Ñ–∞–π–ª—ñ–≤)
pip install -r requirements-dev.txt

# –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Ç–µ—Å—Ç–∏
pytest

# –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –∑ –¥–µ—Ç–∞–ª—å–Ω–∏–º –≤–∏–≤–æ–¥–æ–º
pytest -v
```

## –õ—ñ—Ü–µ–Ω–∑—ñ—è

BSD 3-Clause License

## –ê–≤—Ç–æ—Ä—Å—å–∫—ñ –ø—Ä–∞–≤–∞

Copyright (c) 2025, Vladyslav V. Prodan

## –ö–æ–Ω—Ç–∞–∫—Ç–∏

- GitHub: [github.com/click0](https://github.com/click0)
- –¢–µ–ª–µ—Ñ–æ–Ω: +38(099)6053340
